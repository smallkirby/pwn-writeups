#!/usr/bin/env python
#encoding: utf-8;

from pwn import *
import sys

FILENAME = "./ezstack"

rhp1 = {"host":"ezstack.ctf.jyoken.net","port":80}
rhp2 = {'host':"localhost",'port':12300}
context(os='linux',arch='amd64')
binf = ELF(FILENAME)

def hoge(conn,n):
  conn.recvuntil("> ")
  conn.sendline(str(n))

def push(conn,data):
  hoge(1)
  conn.recvuntil("data: ")
  conn.sendline(data)

def pop(conn,size):
  hoge(2)
  conn.recvuntil("size: ")
  conn.sendline(str(size))


def exploit(conn):
  pass


if len(sys.argv)>1:
  if sys.argv[1][0]=="d":
    cmd = """
      set follow-fork-mode parent
    """
    conn = gdb.debug(FILENAME,cmd)
  elif sys.argv[1][0]=="r":
    conn = remote(rhp1["host"],rhp1["port"])
else:
    conn = remote(rhp2['host'],rhp2['port'])
exploit(conn)
conn.interactive()

