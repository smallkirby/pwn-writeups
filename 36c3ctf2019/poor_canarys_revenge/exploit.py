#!/usr/bin/env python
#encoding: utf-8;

from pwn import *
import sys

FILENAME = "./chall"

rhp2 = {'host':"localhost",'port':123450}
context(os='linux',arch='arm')
binf = ELF(FILENAME)

#https://w3challs.com/syscalls/?arch=arm_strong

def exploit(conn):
  conn.send("A"*2)


if len(sys.argv)>1:
  if sys.argv[1][0]=="d":
    cmd = """
      source ~/pwndbg/gdbinit.py
      set follow-fork-mode child
      b main
      b *0x107a8
      b *0x0107e8
      c
    """
    conn = gdb.debug(FILENAME,cmd)
  elif sys.argv[1][0]=="r":
    conn = remote(rhp1["host"],rhp1["port"])
else:
    conn = remote(rhp2['host'],rhp2['port'])
exploit(conn)
conn.interactive()

