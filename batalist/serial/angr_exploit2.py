#!/usr/bin/env python2

import angr

addr_success = 0x400e61
addr_numonly = 0x400d27
addr_wrong =  0x400e7d

p = angr.Project("./serial",load_options={"auto_load_libs":False})
state = p.factory.entry_state()
simgr = p.factory.simulation_manager(state)
simgr.explore(find=(addr_success,), avoid=(addr_numonly,addr_wrong))

found = simgr.found[0]

for path in simgr.found:
  print(path.posix.dumps(1))
  print(path.posix.dumps(0))
